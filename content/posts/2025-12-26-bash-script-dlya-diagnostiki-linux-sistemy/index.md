---
title: "Bash-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ Linux —Å–∏—Å—Ç–µ–º—ã"
date: 2025-12-26T10:00:00+03:00
description: "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π bash-—Å–∫—Ä–∏–ø—Ç –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–æ–¥–∏—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É Linux —Å–∏—Å—Ç–µ–º—ã: –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É, –ª–æ–≥–∏, –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–µ—Ç–µ–≤—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç. –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π."
tags: [bash, linux, monitoring, diagnostic, sysadmin, devops]
thumbnail: "images/image.png"
---

–ö–æ–≥–¥–∞ —Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä—É–µ—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤, –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ö–æ—á–µ—à—å –±—ã—Å—Ç—Ä–æ –ø–æ–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã - –æ–±—ã—á–Ω–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ—Å—è—Ç–æ–∫ –∫–æ–º–∞–Ω–¥, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏, —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏. –ù–æ —á—Ç–æ –µ—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –≤—Å—ë –æ–¥–Ω–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º?

![diagnostic](images/image.png)

–°–µ–≥–æ–¥–Ω—è —è –ø–æ–∫–∞–∂—É –≤–∞–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π bash-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–æ–¥–∏—Ç –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É Linux —Å–∏—Å—Ç–µ–º—ã –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–π –æ—Ç—á–µ—Ç –ø—Ä—è–º–æ –≤ –∫–æ–Ω—Å–æ–ª–∏. –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Ubuntu, Debian, CentOS, RHEL, Fedora, Arch –∏ –¥—Ä—É–≥–∏—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–•–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å? –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
curl -s https://gist.githubusercontent.com/itcaat/45edeaf15f2d508bee766daa9a97400c/raw/linux-diag-script.sh | sudo bash
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** 
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —á–µ—Ä–µ–∑ `curl | bash`
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞: https://gist.github.com/itcaat/45edeaf15f2d508bee766daa9a97400c
- –°–∫—Ä–∏–ø—Ç —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –Ω–µ –≤–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å–∏—Å—Ç–µ–º—É
- –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É (–°–ø–æ—Å–æ–± 2 –Ω–∏–∂–µ)

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∫—Ä–∏–ø—Ç

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

1. **–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** - –≤–µ—Ä—Å–∏—è –û–°, —è–¥—Ä–æ, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, uptime, –≤–Ω–µ—à–Ω–∏–π IP
2. **–ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã** - CPU, RAM, Swap, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤
3. **–î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ** - –∑–∞–Ω—è—Ç–æ–µ –º–µ—Å—Ç–æ, inodes, SMART —Å—Ç–∞—Ç—É—Å
4. **–¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–∏—Å–∫–æ–≤** - —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏/—á—Ç–µ–Ω–∏—è (100MB —Ç–µ—Å—Ç)
5. **–°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã** - —Å—Ç–∞—Ç—É—Å, –æ—à–∏–±–∫–∏, –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
6. **–¢–µ—Å—Ç —Å–µ—Ç–∏** - ping –¥–æ —à–ª—é–∑–∞, ya.ru –∏ 8.8.8.8 (–ø–æ 10 –ø–∞–∫–µ—Ç–æ–≤ –∫–∞–∂–¥—ã–π), —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
7. **–ü—Ä–æ—Ü–µ—Å—Å—ã** - —Ç–æ–ø –ø–æ CPU –∏ –ø–∞–º—è—Ç–∏, zombie –ø—Ä–æ—Ü–µ—Å—Å—ã
8. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, OOM —Å–æ–±—ã—Ç–∏—è, kernel warnings
9. **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–ª—É–∂–±—ã** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–ø–∞–≤—à–∏—Ö —Å–ª—É–∂–±
10. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ—É–¥–∞—á–Ω—ã–µ –≤—Ö–æ–¥—ã, –∞–∫—Ç–∏–≤–Ω—ã–µ SSH —Å–µ—Å—Å–∏–∏
11. **Docker** - —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –∏—Ö —Ä–µ—Å—É—Ä—Å—ã
12. **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º

## –ü–æ–ª–Ω—ã–π –∫–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞

–°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–∫—Ä–æ–º–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç) –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
#!/bin/bash

#############################################
# Linux System Diagnostic Script
# Universal system diagnostics script
# Version: 1.0
#############################################

# Status symbols
CHECK_OK="‚úì"
CHECK_WARN="‚ö†"
CHECK_CRIT="‚úó"

# Summary variables
WARNINGS=0
CRITICALS=0
PROBLEM_SECTIONS=()  # Array to track sections with problems

# Function for section headers
print_section() {
    echo ""
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "  $1"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
}

# Function for output with status icons
print_status() {
    local status=$1
    local message=$2
    local section=$3  # Optional: section name for tracking
    
    case $status in
        "ok")
            echo "${CHECK_OK} $message"
            ;;
        "warn")
            echo "${CHECK_WARN} $message"
            ((WARNINGS++))
            # Add section to problem list if provided and not already there
            if [ ! -z "$section" ]; then
                if [[ ! " ${PROBLEM_SECTIONS[@]} " =~ " ${section} " ]]; then
                    PROBLEM_SECTIONS+=("$section")
                fi
            fi
            ;;
        "crit")
            echo "${CHECK_CRIT} $message"
            ((CRITICALS++))
            # Add section to problem list if provided and not already there
            if [ ! -z "$section" ]; then
                if [[ ! " ${PROBLEM_SECTIONS[@]} " =~ " ${section} " ]]; then
                    PROBLEM_SECTIONS+=("$section")
                fi
            fi
            ;;
    esac
}

# Check if command exists
command_exists() {
    command -v "$1" >/dev/null 2>&1
}

# Ping function (10 packets)
do_ping() {
    local host=$1
    local description=$2
    local section=$3
    
    echo "  Testing $description ($host):"
    echo -n "    Ping (10 packets): "
    
    PING_RESULT=$(ping -c 10 -q "$host" 2>/dev/null)
    if [ $? -eq 0 ]; then
        PACKET_LOSS=$(echo "$PING_RESULT" | grep "packet loss" | awk '{print $6}')
        AVG_TIME=$(echo "$PING_RESULT" | grep "rtt" | awk -F'/' '{print $5}')
        
        echo "Loss: $PACKET_LOSS, Avg: ${AVG_TIME}ms"
        
        # Check packet loss
        LOSS_PERCENT=$(echo "$PACKET_LOSS" | sed 's/%//')
        if [ "$LOSS_PERCENT" -gt 20 ]; then
            print_status "crit" "High packet loss to $description!" "$section"
        elif [ "$LOSS_PERCENT" -gt 5 ]; then
            print_status "warn" "Packet loss detected to $description" "$section"
        else
            print_status "ok" "$description is reachable"
        fi
    else
        echo "Failed"
        print_status "crit" "Cannot reach $description!" "$section"
    fi
    echo ""
}

#############################################
# 1. SYSTEM INFORMATION
#############################################
check_system_info() {
    print_section "SYSTEM INFORMATION"
    
    echo "Hostname: $(hostname)"
    echo "OS: $(cat /etc/os-release 2>/dev/null | grep PRETTY_NAME | cut -d'"' -f2 || uname -s)"
    echo "Kernel: $(uname -r)"
    echo "Architecture: $(uname -m)"
    echo "Uptime: $(uptime -p 2>/dev/null || uptime | awk -F'up ' '{print $2}' | awk -F',' '{print $1}')"
    
    # External IP address (using public services)
    if command_exists curl; then
        # Try to get IP from 2ip.ru, fallback to icanhazip.com
        EXTERNAL_IP=$(curl -s --max-time 5 https://2ip.ru 2>/dev/null || curl -s --max-time 5 https://icanhazip.com 2>/dev/null || echo "N/A")
        # Clean result - extract only IPv4 address
        EXTERNAL_IP=$(echo "$EXTERNAL_IP" | grep -oE '^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' | head -1)
        if [ -z "$EXTERNAL_IP" ]; then
            EXTERNAL_IP="N/A"
        fi
        echo "External IP: $EXTERNAL_IP"
    fi
    
    # CPU information
    if [ -f /proc/cpuinfo ]; then
        CPU_MODEL=$(grep "model name" /proc/cpuinfo | head -1 | cut -d':' -f2 | xargs)
        CPU_CORES=$(grep -c "processor" /proc/cpuinfo)
        echo "CPU: $CPU_MODEL ($CPU_CORES cores)"
    fi
    
    # RAM information
    if command_exists free; then
        TOTAL_RAM=$(free -h | awk '/^Mem:/ {print $2}')
        echo "Total RAM: $TOTAL_RAM"
    fi
}

#############################################
# 2. SYSTEM RESOURCES
#############################################
check_resources() {
    print_section "RESOURCE USAGE"
    
    # Load Average
    if [ -f /proc/loadavg ]; then
        LOAD_AVG=$(cat /proc/loadavg | awk '{print $1, $2, $3}')
        CPU_CORES=$(grep -c "processor" /proc/cpuinfo)
        LOAD_1MIN=$(cat /proc/loadavg | awk '{print $1}')
        
        echo "Load Average: $LOAD_AVG (${CPU_CORES} cores)"
        
        # Check load
        if (( $(echo "$LOAD_1MIN > $CPU_CORES * 2" | bc -l) )); then
            print_status "crit" "High CPU load!" "Resources"
        elif (( $(echo "$LOAD_1MIN > $CPU_CORES" | bc -l) )); then
            print_status "warn" "Elevated CPU load" "Resources"
        else
            print_status "ok" "Load is normal"
        fi
    fi
    
    echo ""
    
    # Memory
    if command_exists free; then
        echo "Memory:"
        free -h
        
        # Check memory usage
        MEM_USED_PERCENT=$(free | grep Mem | awk '{print int($3/$2 * 100)}')
        echo ""
        if [ "$MEM_USED_PERCENT" -gt 90 ]; then
            print_status "crit" "Memory usage: ${MEM_USED_PERCENT}% (critical!)" "Resources"
        elif [ "$MEM_USED_PERCENT" -gt 80 ]; then
            print_status "warn" "Memory usage: ${MEM_USED_PERCENT}%" "Resources"
        else
            print_status "ok" "Memory usage: ${MEM_USED_PERCENT}%"
        fi
        
        # Check swap
        SWAP_USED_PERCENT=$(free | grep Swap | awk '{if ($2 > 0) print int($3/$2 * 100); else print 0}')
        if [ "$SWAP_USED_PERCENT" -gt 50 ]; then
            print_status "warn" "Swap usage: ${SWAP_USED_PERCENT}%" "Resources"
        elif [ "$SWAP_USED_PERCENT" -gt 0 ]; then
            print_status "ok" "Swap usage: ${SWAP_USED_PERCENT}%"
        fi
    fi
}

#############################################
# 3. TEMPERATURE
#############################################
check_temperature() {
    print_section "TEMPERATURE"
    
    # Check sensors (lm-sensors)
    if command_exists sensors; then
        sensors 2>/dev/null | grep -E "^(Core|CPU|temp)" | head -10
        
        echo ""
        
        # Check critical temperatures
        HIGH_TEMP=$(sensors 2>/dev/null | grep -oP '\+\K[0-9]+' | awk '{if ($1 > 80) print $1}' | head -1)
        if [ ! -z "$HIGH_TEMP" ]; then
            print_status "crit" "High temperature detected: ${HIGH_TEMP}¬∞C!" "Temperature"
        else
            print_status "ok" "Temperature is normal"
        fi
    else
        print_status "warn" "'sensors' utility not installed" "Temperature"
        echo ""
        echo "To install lm-sensors:"
        echo "  Ubuntu/Debian: sudo apt install lm-sensors && sudo sensors-detect"
        echo "  CentOS/RHEL:   sudo yum install lm_sensors"
        echo "  Fedora:        sudo dnf install lm_sensors"
        echo "  Arch:          sudo pacman -S lm_sensors"
    fi
}

#############################################
# 4. DISK SPACE
#############################################
check_disk_space() {
    print_section "DISK SPACE"
    
    echo "Partition usage:"
    df -h -x tmpfs -x devtmpfs | grep -v "^Filesystem"
    
    echo ""
    
    # Check partition usage
    df -h -x tmpfs -x devtmpfs | grep -v "^Filesystem" | awk '{print $5 " " $6}' | while read line; do
        USAGE=$(echo $line | awk '{print $1}' | sed 's/%//')
        MOUNT=$(echo $line | awk '{print $2}')
        
        if [ "$USAGE" -gt 90 ]; then
            print_status "crit" "Partition $MOUNT is ${USAGE}% full!" "Disk Space"
        elif [ "$USAGE" -gt 80 ]; then
            print_status "warn" "Partition $MOUNT is ${USAGE}% full" "Disk Space"
        fi
    done
    
    # Check inodes
    echo ""
    echo "Inodes usage (top-5 partitions):"
    df -i -x tmpfs -x devtmpfs | grep -v "^Filesystem" | awk '{print $5 " " $6}' | while read line; do
        USAGE_PERCENT=$(echo $line | awk '{print $1}')
        MOUNT=$(echo $line | awk '{print $2}')
        USAGE=$(echo $USAGE_PERCENT | sed 's/%//' | grep -E '^[0-9]+$')
        
        if [ ! -z "$USAGE" ]; then
            echo "  $MOUNT: ${USAGE_PERCENT}"
            
            if [ "$USAGE" -gt 90 ]; then
                print_status "crit" "Inodes on $MOUNT critically full!" "Disk Space"
            elif [ "$USAGE" -gt 80 ]; then
                print_status "warn" "Inodes on $MOUNT need attention" "Disk Space"
            fi
        fi
    done | head -15
    
    # SMART status (if available)
    if command_exists smartctl; then
        echo ""
        echo "SMART disk status:"
        for disk in $(lsblk -d -o name,type 2>/dev/null | awk '$2=="disk" {print $1}'); do
            SMART_STATUS=$(smartctl -H /dev/$disk 2>/dev/null | grep "SMART overall-health")
            
            if [ -z "$SMART_STATUS" ]; then
                echo "  /dev/$disk: N/A"
            else
                echo "  /dev/$disk: $SMART_STATUS"
                
                # Check for FAILED
                if echo "$SMART_STATUS" | grep -qi "FAILED"; then
                    print_status "crit" "Disk /dev/$disk has SMART problems!" "Disk Space"
                fi
            fi
        done
    fi
}

#############################################
# 4.5. DISK SPEED TEST
#############################################
check_disk_speed() {
    print_section "DISK SPEED TEST"
    
    # Check if dd is available
    if ! command_exists dd; then
        print_status "warn" "'dd' utility not found"
        return
    fi
    
    # Get root partition
    ROOT_MOUNT=$(df / | tail -1 | awk '{print $6}')
    TEST_FILE="/tmp/disk_speed_test_$$"
    
    echo "Write/Read speed test for $ROOT_MOUNT:"
    echo "  (using 100MB temporary file)"
    echo ""
    
    # Write speed test
    echo -n "  Write speed: "
    WRITE_SPEED=$(dd if=/dev/zero of="$TEST_FILE" bs=1M count=100 oflag=direct 2>&1 | grep -oP '[0-9.]+ MB/s' | head -1)
    if [ -z "$WRITE_SPEED" ]; then
        # Alternative parsing for different dd versions
        WRITE_SPEED=$(dd if=/dev/zero of="$TEST_FILE" bs=1M count=100 oflag=direct 2>&1 | tail -1 | awk '{print $(NF-1), $NF}')
    fi
    echo "$WRITE_SPEED"
    
    # Clear cache (if permissions allow)
    sync
    if [ -w /proc/sys/vm/drop_caches ]; then
        echo 3 > /proc/sys/vm/drop_caches 2>/dev/null
    fi
    
    # Read speed test
    echo -n "  Read speed:  "
    READ_SPEED=$(dd if="$TEST_FILE" of=/dev/null bs=1M 2>&1 | grep -oP '[0-9.]+ MB/s' | head -1)
    if [ -z "$READ_SPEED" ]; then
        # Alternative parsing for different dd versions
        READ_SPEED=$(dd if="$TEST_FILE" of=/dev/null bs=1M 2>&1 | tail -1 | awk '{print $(NF-1), $NF}')
    fi
    echo "$READ_SPEED"
    
    # Remove test file
    rm -f "$TEST_FILE"
    
    echo ""
    print_status "ok" "Disk speed test completed"
    echo ""
    echo "Note: This is a basic test. For detailed analysis use fio or hdparm."
}

#############################################
# 6. NETWORK DIAGNOSTICS
#############################################
check_network() {
    print_section "NETWORK DIAGNOSTICS"
    
    echo "Network interfaces:"
    if command_exists ip; then
        ip -br addr show | grep -v "^lo"
    else
        ifconfig | grep -E "^[a-z]|inet "
    fi
    
    echo ""
    
    # Check interface errors
    if [ -f /proc/net/dev ]; then
        echo "Interface errors:"
        awk 'NR>2 {print $1, $4, $12}' /proc/net/dev | while read iface rx_errors tx_errors; do
            iface=$(echo $iface | sed 's/:$//')
            if [ "$iface" != "lo" ]; then
                TOTAL_ERRORS=$((rx_errors + tx_errors))
                if [ "$TOTAL_ERRORS" -gt 100 ]; then
                    print_status "warn" "$iface: RX errors: $rx_errors, TX errors: $tx_errors" "Network"
                fi
            fi
        done
    fi
    
    echo ""
    
    # Active connections (external)
    echo "Top-10 external connections (by IP):"
    
    # Get local IP addresses for filtering
    LOCAL_IPS=$(ip addr show 2>/dev/null | grep -oP 'inet \K[\d.]+' | grep -v '^127\.')
    
    if command_exists ss; then
        CONNECTIONS=$(ss -tun state established 2>/dev/null | awk 'NR>1 {print $5}' | grep -v "^$" | sed 's/:[0-9]*$//' | grep -E '^[0-9]+\.' | grep -v "^127\.\|^0\.0\.0\.0")
    else
        CONNECTIONS=$(netstat -tun 2>/dev/null | grep ESTABLISHED | awk '{print $5}' | sed 's/:[0-9]*$//' | grep -E '^[0-9]+\.' | grep -v "^127\.\|^0\.0\.0\.0")
    fi
    
    # Filter local IPs
    FILTERED_CONNECTIONS=""
    for ip in $CONNECTIONS; do
        IS_LOCAL=0
        for local_ip in $LOCAL_IPS; do
            if [ "$ip" = "$local_ip" ]; then
                IS_LOCAL=1
                break
            fi
        done
        if [ $IS_LOCAL -eq 0 ]; then
            FILTERED_CONNECTIONS="$FILTERED_CONNECTIONS$ip\n"
        fi
    done
    
    if [ -z "$FILTERED_CONNECTIONS" ]; then
        echo "  No active external connections"
    else
        echo -e "$FILTERED_CONNECTIONS" | grep -v "^$" | sort | uniq -c | sort -rn | head -10
    fi
    
    # Network connectivity tests
    echo ""
    echo "Network connectivity tests:"
    echo ""
    
    # 1. Ping to gateway
    GATEWAY=$(ip route | grep default | awk '{print $3}' | head -1)
    if [ ! -z "$GATEWAY" ]; then
        do_ping "$GATEWAY" "Gateway" "Network"
    else
        echo "  Gateway: Not found"
        print_status "warn" "No default gateway found" "Network"
        echo ""
    fi
    
    # 2. Ping to ya.ru
    do_ping "ya.ru" "ya.ru (DNS + connectivity)" "Network"
    
    # 3. Ping to 8.8.8.8
    do_ping "8.8.8.8" "Google DNS" "Network"
    
    # Internet speed test (optional)
    echo ""
    if command_exists curl; then
        echo "Internet speed test:"
        echo -n "  Download (testing 100MB file): "
        
        # Test download speed using curl
        # %{speed_download} returns speed in bytes/sec
        DOWNLOAD_SPEED=$(curl -o /dev/null -s -w '%{speed_download}' --max-time 15  http://speedtest.selectel.ru/100MB 2>/dev/null)
        
        if [ ! -z "$DOWNLOAD_SPEED" ] && [ "$DOWNLOAD_SPEED" != "0.000" ] && [ "$DOWNLOAD_SPEED" != "0" ]; then
            # Convert bytes/sec to MB/s (divide by 1048576)
            if command_exists bc; then
                DOWNLOAD_MBPS=$(echo "scale=2; $DOWNLOAD_SPEED / 1048576" | bc 2>/dev/null)
            else
                # Without bc use awk
                DOWNLOAD_MBPS=$(awk "BEGIN {printf \"%.2f\", $DOWNLOAD_SPEED / 1048576}")
            fi
            
            if [ ! -z "$DOWNLOAD_MBPS" ] && [ "$DOWNLOAD_MBPS" != "0.00" ]; then
                echo "${DOWNLOAD_MBPS} MB/s"
            else
                echo "N/A (file too small for measurement)"
            fi
        else
            echo "N/A (check internet connection)"
        fi
    fi
}

#############################################
# 7. PROCESSES
#############################################
check_processes() {
    print_section "PROCESSES"
    
    echo "Top-10 processes by CPU:"
    ps aux --sort=-%cpu | head -11 | tail -10
    
    echo ""
    echo "Top-10 processes by memory:"
    ps aux --sort=-%mem | head -11 | tail -10
    
    # Zombie processes
    echo ""
    ZOMBIE_COUNT=$(ps aux | awk '{if ($8 == "Z") print $0}' | wc -l)
    if [ "$ZOMBIE_COUNT" -gt 0 ]; then
        print_status "warn" "Found zombie processes: $ZOMBIE_COUNT" "Processes"
        ps aux | awk '{if ($8 == "Z") print $0}'
    else
        print_status "ok" "No zombie processes found"
    fi
    
    # Total processes
    echo ""
    TOTAL_PROCESSES=$(ps aux | wc -l)
    echo "Total processes: $TOTAL_PROCESSES"
}

#############################################
# 8. LOG ANALYSIS
#############################################
check_logs() {
    print_section "SYSTEM LOG ANALYSIS"
    
    # Detect logging system
    if command_exists journalctl; then
        echo "Critical errors in last 24 hours (journalctl):"
        journalctl -p err -S "24 hours ago" --no-pager | tail -20
        
        echo ""
        echo "OOM (Out of Memory) events:"
        journalctl -k | grep -i "out of memory\|oom" | tail -10
        
    elif [ -f /var/log/syslog ]; then
        echo "Critical errors (syslog):"
        grep -i "error\|critical\|fail" /var/log/syslog | tail -20
        
        echo ""
        echo "OOM events:"
        grep -i "out of memory\|oom" /var/log/syslog | tail -10
        
    elif [ -f /var/log/messages ]; then
        echo "Critical errors (messages):"
        grep -i "error\|critical\|fail" /var/log/messages | tail -20
        
        echo ""
        echo "OOM events:"
        grep -i "out of memory\|oom" /var/log/messages | tail -10
    fi
    
    # Kernel warnings
    echo ""
    echo "Kernel warnings (dmesg):"
    if command_exists dmesg; then
        # Use -T to show real time (if supported)
        if dmesg -T >/dev/null 2>&1; then
            dmesg -T -l err,crit,alert,emerg 2>/dev/null | tail -15
        else
            # For older versions without -T support
            dmesg -l err,crit,alert,emerg 2>/dev/null | tail -15
        fi
    fi
    
    # Failed SSH attempts
    echo ""
    echo "Failed SSH attempts (last 10):"
    if [ -f /var/log/auth.log ]; then
        grep "Failed password" /var/log/auth.log | tail -10
    elif [ -f /var/log/secure ]; then
        grep "Failed password" /var/log/secure | tail -10
    fi
}

#############################################
# 9. SYSTEM SERVICES
#############################################
check_services() {
    print_section "SYSTEM SERVICES"
    
    if command_exists systemctl; then
        echo "Failed services:"
        FAILED_SERVICES=$(systemctl list-units --state=failed --no-pager --no-legend)
        
        if [ -z "$FAILED_SERVICES" ]; then
            print_status "ok" "No failed services found"
        else
            print_status "crit" "Failed services found:" "Services"
            echo "$FAILED_SERVICES"
        fi
    else
        echo "systemctl not found, check services manually"
    fi
}

#############################################
# 10. SECURITY
#############################################
check_security() {
    print_section "SECURITY"
    
    # Last successful logins
    echo "Last successful logins:"
    if command_exists last; then
        last -n 10 | grep -v "^$\|^wtmp"
    fi
    
    echo ""
    
    # Active SSH sessions
    echo "Active SSH sessions:"
    who | grep -v "^$"
    
    # Check number of active SSH sessions
    SSH_COUNT=$(who | wc -l)
    if [ "$SSH_COUNT" -gt 5 ]; then
        print_status "warn" "Detected $SSH_COUNT active SSH sessions" "Security"
    fi
    
    echo ""
    
    # Sudo activity in last 24 hours
    echo "Sudo activity in last 24 hours:"
    if [ -f /var/log/auth.log ]; then
        grep "sudo.*COMMAND" /var/log/auth.log | tail -10
    elif [ -f /var/log/secure ]; then
        grep "sudo.*COMMAND" /var/log/secure | tail -10
    fi
}

#############################################
# 11. DOCKER (if installed)
#############################################
check_docker() {
    if command_exists docker; then
        print_section "DOCKER"
        
        echo "Container status:"
        docker ps -a --format "table {{.Names}}\t{{.Status}}\t{{.Image}}"
        
        echo ""
        
        # Check for exited containers
        EXITED_CONTAINERS=$(docker ps -a --filter "status=exited" --format "{{.Names}}" | wc -l)
        if [ "$EXITED_CONTAINERS" -gt 0 ]; then
            print_status "warn" "Found stopped containers: $EXITED_CONTAINERS" "Docker"
        else
            print_status "ok" "All containers are running"
        fi
        
        echo ""
        echo "Resource usage by containers:"
        docker stats --no-stream --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}"
    fi
}

#############################################
# FINAL REPORT
#############################################
generate_summary() {
    print_section "DIAGNOSTIC SUMMARY"
    
    echo "Check date and time: $(date '+%Y-%m-%d %H:%M:%S')"
    echo "Hostname: $(hostname)"
    echo ""
    
    # Hardware summary
    echo "Hardware Summary:"
    echo ""
    
    # CPU info
    if [ -f /proc/cpuinfo ]; then
        CPU_MODEL=$(grep "model name" /proc/cpuinfo | head -1 | cut -d':' -f2 | xargs)
        CPU_CORES=$(grep -c "processor" /proc/cpuinfo)
        echo "  CPU: $CPU_MODEL"
        echo "  Cores: $CPU_CORES"
    fi
    
    # RAM info
    if command_exists free; then
        TOTAL_RAM=$(free -h | awk '/^Mem:/ {print $2}')
        USED_RAM=$(free -h | awk '/^Mem:/ {print $3}')
        MEM_PERCENT=$(free | grep Mem | awk '{print int($3/$2 * 100)}')
        echo "  RAM: $USED_RAM / $TOTAL_RAM (${MEM_PERCENT}%)"
    fi
    
    # Disk info
    if command_exists df; then
        TOTAL_DISK=$(df -h --total 2>/dev/null | grep total | awk '{print $2}' || df -h / | tail -1 | awk '{print $2}')
        USED_DISK=$(df -h --total 2>/dev/null | grep total | awk '{print $3}' || df -h / | tail -1 | awk '{print $3}')
        echo "  Disk: $USED_DISK / $TOTAL_DISK"
    fi
    
    # Load Average
    if [ -f /proc/loadavg ]; then
        LOAD_AVG=$(cat /proc/loadavg | awk '{print $1, $2, $3}')
        echo "  Load Average: $LOAD_AVG"
    fi
    
    # Uptime
    UPTIME=$(uptime -p 2>/dev/null || uptime | awk -F'up ' '{print $2}' | awk -F',' '{print $1}')
    echo "  Uptime: $UPTIME"
    
    echo ""
    echo "Diagnostic Results:"
    echo ""
    
    if [ "$CRITICALS" -eq 0 ] && [ "$WARNINGS" -eq 0 ]; then
        echo "${CHECK_OK} System is in excellent condition!"
    elif [ "$CRITICALS" -eq 0 ]; then
        echo "${CHECK_WARN} Warnings detected: $WARNINGS"
        echo "Recommended to pay attention to the indicated issues."
    else
        echo "${CHECK_CRIT} ATTENTION! Critical problems detected!"
        echo "Critical: $CRITICALS"
        echo "Warnings: $WARNINGS"
    fi
    
    # Show problem sections if any
    if [ ${#PROBLEM_SECTIONS[@]} -gt 0 ]; then
        echo ""
        echo "Sections with problems:"
        for section in "${PROBLEM_SECTIONS[@]}"; do
            echo "  ‚Ä¢ $section"
        done
    fi
    
    echo ""
    echo "Recommendations:"
    
    if [ "$CRITICALS" -gt 0 ] || [ "$WARNINGS" -gt 0 ]; then
        echo "  ‚Ä¢ Review the report above and fix the detected problems"
        echo "  ‚Ä¢ Check logs for detailed information"
        echo "  ‚Ä¢ Free up disk space if necessary"
        echo "  ‚Ä¢ Restart failed services"
    else
        echo "  ‚Ä¢ Continue regular system monitoring"
        echo "  ‚Ä¢ Recommended to run this script once a day"
    fi
    
    # Return error code for monitoring systems integration
    if [ "$CRITICALS" -gt 0 ]; then
        return 2  # Critical problems exist
    elif [ "$WARNINGS" -gt 0 ]; then
        return 1  # Warnings exist
    else
        return 0  # All is good
    fi
}

#############################################
# TELEGRAM NOTIFICATION
#############################################
send_telegram_notification() {
    local exit_code=$1
    local report_file=$2
    
    # Check if Telegram credentials are set
    if [ -z "$TELEGRAM_BOT_TOKEN" ] || [ -z "$TELEGRAM_CHAT_ID" ]; then
        return 0
    fi
    
    # Only send if there are problems
    if [ "$exit_code" -eq 0 ]; then
        return 0
    fi
    
    # Check if curl is available
    if ! command_exists curl; then
        echo "Warning: curl not found, cannot send Telegram notification"
        return 1
    fi
    
    # Prepare message
    local hostname=$(hostname)
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    local status_emoji=""
    local status_text=""
    
    if [ "$exit_code" -eq 2 ]; then
        status_emoji="üö®"
        status_text="CRITICAL PROBLEMS"
    else
        status_emoji="‚ö†Ô∏è"
        status_text="WARNINGS"
    fi
    
    # Build message
    local message="${status_emoji} ${status_text} on ${hostname}!

Time: ${timestamp}
Critical: ${CRITICALS}
Warnings: ${WARNINGS}"
    
    # Add problem sections if any
    if [ ${#PROBLEM_SECTIONS[@]} -gt 0 ]; then
        message="${message}

Sections with problems:"
        for section in "${PROBLEM_SECTIONS[@]}"; do
            message="${message}
  ‚Ä¢ ${section}"
        done
    fi
    
    message="${message}

Please check the detailed report."
    
    # Send message
    curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage" \
        -d chat_id="${TELEGRAM_CHAT_ID}" \
        -d text="${message}" >/dev/null 2>&1
    
    # Send report file if it exists
    if [ -f "$report_file" ]; then
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendDocument" \
            -F chat_id="${TELEGRAM_CHAT_ID}" \
            -F document=@"${report_file}" \
            -F caption="Full diagnostic report" >/dev/null 2>&1
    fi
}

#############################################
# MAIN FUNCTION
#############################################
main() {
    # Temporary file for report
    TEMP_REPORT="/tmp/system_diagnostic_$(date +%Y%m%d_%H%M%S).txt"
    TEMP_COUNTERS="/tmp/system_diagnostic_counters_$$.tmp"
    
    # Run diagnostics and capture output
    {
        clear
        echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
        echo "‚ïë                                                                ‚ïë"
        echo "‚ïë        LINUX SYSTEM DIAGNOSTICS                               ‚ïë"
        echo "‚ïë        System Diagnostic Script v1.0                          ‚ïë"
        echo "‚ïë                                                                ‚ïë"
        echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
        echo ""
        
        # Check root privileges (some checks require sudo)
        if [ "$EUID" -ne 0 ]; then 
            echo "${CHECK_WARN} Script running without root privileges. Some checks may be unavailable."
            echo "For full diagnostics run: sudo $0"
            echo ""
        fi
        
        # Run all checks
        check_system_info
        check_resources
        check_temperature
        check_disk_space
        check_disk_speed
        check_network
        check_processes
        check_logs
        check_services
        check_security
        check_docker
        
        # Final summary
        generate_summary
        
        # Save counters and problem sections to file (to survive tee subshell)
        echo "$CRITICALS" > "$TEMP_COUNTERS"
        echo "$WARNINGS" >> "$TEMP_COUNTERS"
        # Save problem sections (one per line)
        for section in "${PROBLEM_SECTIONS[@]}"; do
            echo "$section" >> "$TEMP_COUNTERS"
        done
    } | tee "$TEMP_REPORT"
    
    # Read counters from file
    if [ -f "$TEMP_COUNTERS" ]; then
        CRITICALS=$(sed -n '1p' "$TEMP_COUNTERS")
        WARNINGS=$(sed -n '2p' "$TEMP_COUNTERS")
        # Read problem sections (starting from line 3)
        PROBLEM_SECTIONS=()
        while IFS= read -r section; do
            PROBLEM_SECTIONS+=("$section")
        done < <(tail -n +3 "$TEMP_COUNTERS")
        rm -f "$TEMP_COUNTERS"
    fi
    
    # Determine exit code from counters
    if [ "$CRITICALS" -gt 0 ]; then
        EXIT_CODE=2
    elif [ "$WARNINGS" -gt 0 ]; then
        EXIT_CODE=1
    else
        EXIT_CODE=0
    fi
    
    # Send Telegram notification if configured and there are problems
    send_telegram_notification "$EXIT_CODE" "$TEMP_REPORT"
    
    # Clean up temp files
    if [ -z "$TELEGRAM_BOT_TOKEN" ] || [ -z "$TELEGRAM_CHAT_ID" ]; then
        rm -f "$TEMP_REPORT"
    else
        # Keep report for a short time in case of retry
        (sleep 60 && rm -f "$TEMP_REPORT") &
    fi
    
    # Clean up counter file if exists
    rm -f "$TEMP_COUNTERS"
    
    # Exit with appropriate code
    exit $EXIT_CODE
}

# Run script
main
```

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –ø—Ä—è–º–æ –∏–∑ [GitHub Gist](https://gist.github.com/itcaat/45edeaf15f2d508bee766daa9a97400c):

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø—Ä–∞–≤–∞–º–∏ root
curl -s https://gist.githubusercontent.com/itcaat/45edeaf15f2d508bee766daa9a97400c/raw/linux-diag-script.sh | sudo bash
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –≤ —Ñ–∞–π–ª

–ß—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–∞–π–ª –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:

```bash
# –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ curl
curl -s https://gist.githubusercontent.com/itcaat/45edeaf15f2d508bee766daa9a97400c/raw/linux-diag-script.sh | sudo bash | tee diagnostic_$(date +%Y%m%d_%H%M%S).txt

# –ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ
sudo ./linux-diag.sh | tee diagnostic_$(date +%Y%m%d_%H%M%S).txt
```

### –ß—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- Load Average –ø—Ä–µ–≤—ã—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä CPU –≤ 2 —Ä–∞–∑–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ > 90%
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ > 80¬∞C
- –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω > 90%
- Inodes –∑–∞–ø–æ–ª–Ω–µ–Ω—ã > 90%
- SMART —Å—Ç–∞—Ç—É—Å –¥–∏—Å–∫–∞: FAILED
- –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
- –ï—Å—Ç—å —É–ø–∞–≤—à–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–ª—É–∂–±—ã

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
- Load Average –ø—Ä–µ–≤—ã—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä CPU
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ > 80%
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ swap > 50%
- –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω > 80%
- Inodes –∑–∞–ø–æ–ª–Ω–µ–Ω—ã > 80%
- –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã zombie –ø—Ä–æ—Ü–µ—Å—Å—ã
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –Ω–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
- –ú–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö SSH —Å–µ—Å—Å–∏–π (> 5)

**–í —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –æ—Ç—á–µ—Ç–µ:**

–í –Ω–∞—á–∞–ª–µ –∏—Ç–æ–≥–æ–≤–æ–π —Å–≤–æ–¥–∫–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∂–µ–ª–µ–∑–µ (CPU, RAM, Disk, Load Average, Uptime), –∞ —Ç–∞–∫–∂–µ —Å–ø–∏—Å–æ–∫ —Å–µ–∫—Ü–∏–π —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ä–∞–∑—É –≤–∏–¥–µ—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã –∏ –±—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏.

## –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫—Ä–∏–ø—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

**TELEGRAM_BOT_TOKEN –∏ TELEGRAM_CHAT_ID** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram

```bash
# –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º
export TELEGRAM_BOT_TOKEN="123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
export TELEGRAM_CHAT_ID="987654321"
sudo -E ./linux-diag.sh

# –ò–ª–∏ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É
TELEGRAM_BOT_TOKEN="your_token" \
TELEGRAM_CHAT_ID="your_chat_id" \
sudo -E ./linux-diag.sh
```


### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–æ–≤

–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–µ–∫—Ü–∏—è—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø–∞–º—è—Ç–∏:

```bash
# –í–º–µ—Å—Ç–æ 90% –∏ 80% –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è
if [ "$MEM_USED_PERCENT" -gt 95 ]; then
    print_status "crit" "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ${MEM_USED_PERCENT}% (–∫—Ä–∏—Ç–∏—á–Ω–æ!)"
elif [ "$MEM_USED_PERCENT" -gt 85 ]; then
    print_status "warn" "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ${MEM_USED_PERCENT}%"
```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π

–ï—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ —Å–µ–∫—Ü–∏—è –≤–∞–º –Ω–µ –Ω—É–∂–Ω–∞, –ø—Ä–æ—Å—Ç–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –µ—ë –≤—ã–∑–æ–≤ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `main()`:

```bash
main() {
    # ...
    check_system_info
    check_resources
    # check_temperature  # –æ—Ç–∫–ª—é—á–∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    check_disk_space
    # ...
}
```

## Exit –∫–æ–¥—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

–°–∫—Ä–∏–ø—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ exit –∫–æ–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

| Exit Code | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|----------|
| **0** | –£—Å–ø–µ—Ö | –°–∏—Å—Ç–µ–º–∞ –≤ –æ—Ç–ª–∏—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –ø—Ä–æ–±–ª–µ–º –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ |
| **1** | –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ | –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–Ω–∏–º–∞–Ω–∏–µ |
| **2** | –ö—Ä–∏—Ç–∏—á–Ω–æ | –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ |

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º, –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

**–®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞**

1. –ù–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

**–®–∞–≥ 2: –ü–æ–ª—É—á–∏—Ç–µ Chat ID**

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–∞—à–µ–º—É –±–æ—Ç—É
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":` - —ç—Ç–æ –≤–∞—à Chat ID (–Ω–∞–ø—Ä–∏–º–µ—Ä: `987654321`)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å Telegram

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ
export TELEGRAM_BOT_TOKEN="123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
export TELEGRAM_CHAT_ID="987654321"

sudo -E ./linux-diag.sh
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –í –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É**

```bash
TELEGRAM_BOT_TOKEN="your_token" TELEGRAM_CHAT_ID="your_chat_id" sudo -E ./linux-diag.sh
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ cron**

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/cron.d/system-diagnostic`:

```cron
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
0 */6 * * * root TELEGRAM_BOT_TOKEN="your_token" TELEGRAM_CHAT_ID="your_chat_id" /usr/local/bin/linux-diag.sh >/dev/null 2>&1
```

–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ cron:

```bash
sudo crontab -e
```

```cron
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=987654321

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
0 */6 * * * /usr/local/bin/linux-diag.sh

# –ò–ª–∏ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤—Ä–µ–º—è (6:00, 12:00, 18:00, 00:00)
0 6,12,18,0 * * * /usr/local/bin/linux-diag.sh
```

### –ß—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç:**

1. **–°–æ–æ–±—â–µ–Ω–∏–µ** —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º:
   - –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã (‚ö†Ô∏è Warnings –∏–ª–∏ üö® Critical)
   - –ò–º—è —Ö–æ—Å—Ç–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
   - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–µ–∫—Ü–∏–π

2. **–§–∞–π–ª** —Å –ø–æ–ª–Ω—ã–º –æ—Ç—á–µ—Ç–æ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º –Ω–µ—Ç** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è (—ç–∫–æ–Ω–æ–º–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π).

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç - –æ—Ç–ª–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è Linux —Å–∏—Å—Ç–µ–º—ã. –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç:

- **–°—ç–∫–æ–Ω–æ–º–∏—Ç—å –≤—Ä–µ–º—è** - –≤–º–µ—Å—Ç–æ –¥–µ—Å—è—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç
- **–ù–µ —É–ø—É—Å—Ç–∏—Ç—å –¥–µ—Ç–∞–ª–∏** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- **–ë—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å** - –ø–æ–Ω—è—Ç–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º
- **–û—Ü–µ–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —Ç–µ—Å—Ç—ã —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–∏—Å–∫–æ–≤ –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ª–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ cron —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram
- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

–°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∏ open-source. –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ [GitHub Gist](https://gist.github.com/itcaat/45edeaf15f2d508bee766daa9a97400c). –í—ã –º–æ–∂–µ—Ç–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã, –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –≤–∞—à–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- [–°–∫—Ä–∏–ø—Ç –Ω–∞ GitHub Gist](https://gist.github.com/itcaat/45edeaf15f2d508bee766daa9a97400c) - –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å–∫—Ä–∏–ø—Ç–∞
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ systemd](https://www.freedesktop.org/wiki/Software/systemd/)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ bash scripting](https://www.gnu.org/software/bash/manual/)
- [lm-sensors documentation](https://hwmon.wiki.kernel.org/)

–ò —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ - —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –Ω–µ —Å—Ç–æ–∏—Ç –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –µ–≥–æ –∑–∞–º–µ–Ω–∏—Ç. –ù–æ –æ–Ω –≤–ø–æ–ª–Ω–µ —Å–≥–æ–¥–Ω–∏—Ç—Å—è –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏ "–¥–æ–º–∞—à–Ω–∏—Ö" —Å–µ—Ä–≤–∞–∫–æ–≤.
